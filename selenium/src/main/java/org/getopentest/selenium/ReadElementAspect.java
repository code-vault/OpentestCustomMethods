package org.getopentest.selenium;

import org.getopentest.annotations.TestActionArgument;
import org.getopentest.annotations.TestActionClass;
import org.getopentest.annotations.TestActionOutput;
import org.getopentest.annotations.Type;
import org.getopentest.selenium.core.SeleniumTestAction;
import org.openqa.selenium.By;
import org.openqa.selenium.Dimension;
import org.openqa.selenium.Point;
import org.openqa.selenium.WebElement;

@TestActionClass(
        description = "Reads the position and size of a UI element.")
@TestActionArgument(name = "locator", type = Type.MAP, optional = false,
        description = "The locator of the UI element.")
@TestActionOutput(name = "x", type = Type.INTEGER,
        description = "The x position of the upper-left corner of the UI element.")
@TestActionOutput(name = "y", type = Type.INTEGER,
        description = "The y position of the upper-left corner of the UI element.")
@TestActionOutput(name = "width", type = Type.INTEGER,
        description = "The width of the UI element.")
@TestActionOutput(name = "height", type = Type.INTEGER,
        description = "The height of the UI element.")

/**
 * Reads the position and size of a UI element.
 */
public class ReadElementAspect extends SeleniumTestAction {

    @Override
    public void run() {
        super.run();
        
        By locator = this.readLocatorArgument("locator");

        WebElement element = this.getElement(locator);
        Point point = element.getLocation();

        int x = point.getX();
        int y = point.getY();

        Dimension size = element.getSize();
        int width = size.width;
        int height = size.height;

        this.writeOutput("x", x);
        this.writeOutput("y", y);
        this.writeOutput("width", width);
        this.writeOutput("height", height);
    }

}
